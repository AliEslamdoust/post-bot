// Copyright (c) 2025 Ali Eslamdoust
// MIT License

require("dotenv").config();const{Telegraf:Telegraf}=require("telegraf"),fs=require("fs"),path=require("path"),{v4:uuidv4}=require("uuid"),{logger:logger}=require("./log"),db=require("./db"),pq=require("./cb_p"),axios=require("axios"),mime=require("mime-types");let localVariable=new Object;const bot_token=process.env.BOT_TOKEN,bot=new Telegraf(bot_token);bot.use((async(e,a)=>{const t=e.from.id;localVariable[t]=localVariable[t]?localVariable[t]:new Object;const r=await db.userExists(t);r?a():r||t!=process.env.OWNER||(await db.addUser(t,"owner"),a())})),bot.start((async e=>{const a=e.from.id,t=await db.getUser(a);if(!t.ok)return;const r=await pq.process_queries(t.data,"start",e);sendMessage(r.receiversId,r.messageText,r.inlineKeyboard),localVariable[a].receiver=""})),bot.on("callback_query",(async e=>{const a=e.from.id,t=await db.getUser(a);if(!t.ok)return;const r=e.update.callback_query.data,s=e.msgId;let i;if("start_again"===r)bot.telegram.deleteMessage(a,s),i=await pq.process_queries(t.data,"start",e),sendMessage(a,i.messageText,i.inlineKeyboard);else if(r.includes("watermarkPosition")||r.includes("confirmPost")){const o=path.join(__dirname,`./media/${r.split("_")[1]}.json`);let n=JSON.parse(await fs.promises.readFile(o)),d=r.split("_")[0];if(i=await pq.process_queries(t.data,d,e,n),!i.media.mediaType)return bot.telegram.deleteMessage(a,s),void sendMessage(a,"âŒ Ø§ÛŒÙ† Ù¾Ø³Øª Ø¨Ù‡ Ø¯Ù„ÛŒÙ„ Ú¯Ø°Ø´ØªÙ† Ø§Ø² Ø²Ù…Ø§Ù† Ù…Ø¬Ø§Ø² Ø§Ø² Ø³Ø±ÙˆØ± Ø­Ø°Ù Ø´Ø¯Ù‡ Ø§Ø³Øª. Ù„Ø·ÙØ§ Ù…Ø¬Ø¯Ø¯Ø§ Ø§Ù‚Ø¯Ø§Ù… Ú©Ù†ÛŒØ¯",[[{text:"ğŸ”™ Ø¨Ø§Ø²Ú¯Ø´Øª",callback_data:"start"}]]);sendMessage(i.receiversId,i.messageText,i.inlineKeyboard,void 0,!1,!0,i.media)}else i=await pq.process_queries(t.data,r,e),sendMessage(i.receiversId,i.messageText,i.inlineKeyboard,s,!0);localVariable[a].receiver=i.receiver})),bot.command("help",(e=>{e.reply('â•Ø±Ø§Ù‡Ù†Ù…Ø§:\n\nğŸ”¸Ø´Ø®ØµÛŒ Ø³Ø§Ø²ÛŒ Ø§Ù…Ø¶Ø§ÛŒ Ù¾ÛŒØ§Ù… Ù‡Ø§ Ùˆ ÙˆØ§ØªØ±Ù…Ø§Ø±Ú© Ø§Ø² Ù‚Ø³Ù…Øª "âš™ï¸ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø±Ø¨Ø§Øª"  Ø§Ù…Ú©Ø§Ù† Ù¾Ø°ÛŒØ± Ø§Ø³Øª\nğŸ”¹Ú©Ø§Ø±Ú©Ø±Ø¯ Ø¯Ø±Ø³Øª Ø±Ø¨Ø§Øª Ù…Ù†ÙˆØ· Ø¨Ù‡ Ú©Ø§Ù†ÙÛŒÚ¯ Ú©Ø±Ø¯Ù† Ø¯Ø±Ø³Øª ÙØ§ÛŒÙ„ .env Ø¯Ø± Ú©Ø¯ Ù‡Ø§ÛŒ Ø±Ø¨Ø§Øª Ù…ÛŒ Ø¨Ø§Ø´Ø¯. (Ù†Ù…ÙˆÙ†Ù‡ Ú©Ø§Ù†ÙÛŒÚ¯Ù‘ Ø¯Ø± .env.example Ù‚Ø±Ø§Ø± Ø¯Ø§Ø¯Ù‡ Ø´Ø¯Ù‡)\nğŸ”¸Ø¬Ù‡Øª Ø¯Ø±ÛŒØ§ÙØª Ø¢ÛŒØ¯ÛŒ Ø¹Ø¯Ø¯ÛŒ Ú©Ø§Ù†Ø§Ù„ Ø®ÙˆØ¯ Ø¯Ø³ØªÙˆØ± /getnumericid Ø±Ø§ Ø§Ø±Ø³Ø§Ù„ Ú©Ø±Ø¯Ù‡ Ùˆ ÛŒÚ© Ù¾ÛŒØ§Ù… Ø§Ø² Ú©Ø§Ù†Ø§Ù„ Ù…ÙˆØ±Ø¯ Ù†Ø¸Ø± ÙÙˆØ±ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯')})),bot.command("creator",(e=>{e.reply("Created by Ali Eslamdoust\n@E3410\nGithub: https://github.com/alieslamdoust\nInstagram: https://instagram.com/ali_eslamdoust")}));let waitingForForward=!1;async function sendMessage(e,a,t,r,s,i,o){try{if(a=(a=a||"").replace(/[-()\.=-_\[\]\{\}\<\>\#\+\|]/g,"\\$&"),s&&!i)await bot.telegram.editMessageText(e,r,void 0,a,{reply_markup:{inline_keyboard:t},parse_mode:"MarkdownV2"});else if(s||i){if(!s&&i)if("image"===o.mediaType){let r={caption:a,reply_markup:{inline_keyboard:t},parse_mode:"MarkdownV2"};r.caption||delete r.caption;const s=await bot.telegram.sendPhoto(e,{source:o.filePath},r);if(o.confirm){const t=String(e).replace("-100",""),r=`https://t.me/c/${t}/${s.message_id}`;await db.updatePostStats(o.postId,r),a=(a=o.message.text+`:\n${r}`).replace(/[-()\.=-_\[\]\{\}\<\>\#\+\|]/g,"\\$&"),await bot.telegram.sendMessage(o.message.chatId,a,{reply_markup:{inline_keyboard:o.message.keyboard},parse_mode:"MarkdownV2"})}}else if("video"===o.mediaType){let r={caption:a,reply_markup:{inline_keyboard:t},parse_mode:"MarkdownV2"};r.caption||delete r.caption;const s=await bot.telegram.sendVideo(e,{source:o.filePath,options:r});if(o.confirm){const t=String(e).replace("-100",""),r=`https://t.me/c/${t}/${s.message_id}`;await db.updatePostStats(o.postId,r),a=(a=o.message.text+`:\n${r}`).replace(/[-()\.=-_\[\]\{\}\<\>\#\+\|]/g,"\\$&"),await bot.telegram.sendMessage(o.message.chatId,a,{reply_markup:{inline_keyboard:o.message.keyborad},parse_mode:"MarkdownV2"})}}}else await bot.telegram.sendMessage(e,a,{reply_markup:{inline_keyboard:t},parse_mode:"MarkdownV2"})}catch(e){logger.error("Error while sending a message: "+e)}}async function signMessages(e,a){let t,r=!0;try{e=e||"";const s=await db.getConfig("isSign");if(!s.ok)throw new Error;if(!(1===s.data.value||"1"===s.data.value))return{ok:r,data:e};const i=await db.getConfig("writerSign");if(!i.ok)throw new Error;let o=1===i.data.value||"1"===i.data.value,n="";if(o){const e=await db.getUser(a);if(!e.ok)throw new Error;n=`\n\nğŸ–‹ ${e.data.name}\n`}else n="\n\n";const d=await db.getConfig("signature");if(!d.ok)throw new Error;n+=d.data.value,t=e+n}catch(e){logger.error("Error while signing messages: "+e),r=!1}finally{return{ok:r,data:t}}}function setTimer(e){try{setTimeout((()=>{fs.unlink(e,(e=>{if(e)throw new Error}))}),6e5)}catch(a){setTimer(e),logger.error("Error while deleting files: "+a)}}bot.command("getnumericid",(e=>{e.reply("Ù„Ø·ÙØ§ ÛŒÚ© Ù¾ÛŒØ§Ù… Ø§Ø² Ú©Ø§Ù†Ø§Ù„/Ú¯Ø±ÙˆÙ‡ÛŒ Ú©Ù‡ Ø¢ÛŒØ¯ÛŒ Ø¹Ø¯Ø¯ÛŒ Ø¢Ù† Ø±Ø§ Ù…ÛŒØ®ÙˆØ§Ù‡ÛŒØ¯ Ø¨Ù‡ Ø§ÛŒÙ†Ø¬Ø§ ÙÙˆØ±ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯:"),waitingForForward=!0})),bot.on("message",(async e=>{if(waitingForForward){if(waitingForForward=!1,!e.message.forward_from_chat)return void e.reply("Ù¾ÛŒØ§Ù… Ø¨Ø§ÛŒØ¯ Ø§Ø² Ú©Ø§Ù†Ø§Ù„ Ù…ÙˆØ±Ø¯ Ù†Ø¸Ø± ÙÙˆØ±ÙˆØ§Ø±Ø¯ Ø´Ø¯Ù‡ Ø¨Ø§Ø´Ø¯.");const a=e.message.forward_from_chat.id;return void e.reply(`Ø¢ÛŒØ¯ÛŒ Ø¹Ø¯Ø¯ÛŒ Ú©Ø§Ù†Ø§Ù„/Ú¯Ø±ÙˆÙ‡ Ù…ÙˆØ±Ø¯ Ù†Ø¸Ø±: \`${a}\``)}const a=e.from.id;let t,r,s=!0,i=e.message.text;try{switch(localVariable[a].receiver){case"getNewUserId":if(r=[[{text:"ğŸ”™ Ø¨Ø§Ø²Ú¯Ø´Øª",callback_data:"manageUsers"}]],isNaN(i))return s=!1,t="âŒ Ø¢ÛŒØ¯ÛŒ Ø¹Ø¯Ø¯ÛŒ Ø¨Ø§ÛŒØ¯ ØªÙ†Ù‡Ø§ Ù…ØªØ´Ú©Ù„ Ø§Ø² Ø§Ø¹Ø¯Ø§Ø¯ Ø¨Ø§Ø´Ø¯. Ù„Ø·ÙØ§ Ø¢ÛŒØ¯ÛŒ ØµØ­ÛŒØ­ Ø±Ø§ Ù…Ø¬Ø¯Ø¯Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯\n\nâ—ï¸ Ø¯Ù‚Øª Ú©Ù†ÛŒØ¯ Ú©Ù‡ Ø¹Ø¯Ø¯ Ø¨Ø§ÛŒØ¯ Ø¨Ù‡ Ø§Ù†Ú¯Ù„ÛŒØ³ÛŒ ÙˆØ§Ø±Ø¯ Ø´ÙˆØ¯",void sendMessage(a,t,r);if(!await db.addUser(i))return t="âŒ Ù…Ø´Ú©Ù„ÛŒ Ù¾ÛŒØ´ Ø¢Ù…Ø¯Ù‡ Ø§Ø³Øª. Ù„Ø·ÙØ§ Ø¢ÛŒØ¯ÛŒ Ø¹Ø¯Ø¯ÛŒ Ø±Ø§ Ø¯ÙˆØ¨Ø§Ø±Ù‡ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯",void sendMessage(a,t,r);t="âœ… Ú©Ø§Ø±Ø¨Ø± Ø¬Ø¯ÛŒØ¯ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯\n\nâ” Ø¬Ù‡Øª ØªØºÛŒÛŒØ± Ø³Ø·Ø­ Ø¯Ø³ØªØ±Ø³ÛŒ Ú©Ø§Ø±Ø¨Ø± Ù…ÛŒØªÙˆØ§Ù†ÛŒØ¯ Ø¨Ø§ Ù…Ø±Ø§Ø¬Ø¹Ù‡ Ø¨Ù‡ Ù¾Ø±ÙˆÙØ§ÛŒÙ„ Ø§ÛŒØ´Ø§Ù†ØŒ Ø¯Ø³ØªØ±Ø³ÛŒ Ø±Ø§ ØªØºÛŒÛŒØ± Ø¯Ù‡ÛŒØ¯",sendMessage(a,t,r);break;case"findUserWithId":if(isNaN(i)){t="âŒ Ø¢ÛŒØ¯ÛŒ Ø¹Ø¯Ø¯ÛŒ ÙˆØ§Ø±Ø¯ Ø´Ø¯Ù‡ Ø§Ø´ØªØ¨Ø§Ù‡ Ù…ÛŒØ¨Ø§Ø´Ø¯",r=[[{text:"ğŸ”™ Ø¨Ø§Ø²Ú¯Ø´Øª",callback_data:"seeUsers"}]];break}if(!await db.userExists(i)){t='âŒ Ú©Ø§Ø±Ø¨Ø± Ù…ÙˆØ±Ø¯ Ù†Ø¸Ø± Ø¯Ø± Ø±Ø¨Ø§Øª Ø¹Ø¶Ùˆ Ù†Ù…ÛŒ Ø¨Ø§Ø´Ø¯\nÙ„Ø·ÙØ§ Ø¬Ù‡Øª Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ú©Ø§Ø±Ø¨Ø± Ø¨Ù‡ Ø±Ø¨Ø§Øª Ø§Ø² Ø¨Ø®Ø´ "ğŸ‘¥ Ù…Ø¯ÛŒØ±ÛŒØª Ú©Ø§Ø±Ø¨Ø±Ø§Ù† > â• Ø§ÙØ²ÙˆØ¯Ù† Ú©Ø§Ø±Ø¨Ø± Ø¬Ø¯ÛŒØ¯" Ø§Ù‚Ø¯Ø§Ù… Ú©Ù†ÛŒØ¯',r=[[{text:"ğŸ”™ Ø¨Ø§Ø²Ú¯Ø´Øª",callback_data:"seeUsers"}]];break}const o=await db.getUser(a);if(!o.ok)break;const n=await pq.process_queries({id:a,role:o.data.role},`seeUser/${i}`,e);sendMessage(n.receiversId,n.messageText,n.inlineKeyboard);break;case"newSign":if(r=[[{text:"ğŸ”™ Ø¨Ø§Ø²Ú¯Ø´Øª",callback_data:"settings"}]],"string"!=typeof i)return t="âŒ ÙˆØ±ÙˆØ¯ÛŒ Ø§Ø´ØªØ¨Ø§Ù‡ Ø§Ø³Øª. ÛŒÚ© Ù…ØªÙ† Ú©ÙˆØªØ§Ù‡ Ø¨Ø±Ø§ÛŒ Ø§Ù…Ø¶Ø§ÛŒ Ù¾ÛŒØ§Ù… Ù‡Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯:",void sendMessage(a,t,r);if(!await db.updateConfig("signature",i))return t="âŒ Ù…Ø´Ú©Ù„ÛŒ Ù¾ÛŒØ´ Ø¢Ù…Ø¯. Ù„Ø·ÙØ§ Ø¯ÙˆØ¨Ø§Ø±Ù‡ ØªÙ„Ø§Ø´ Ú©Ù†ÛŒØ¯",void sendMessage(a,t,r);t="âœ… Ø§Ù…Ø¶Ø§ÛŒ Ø¬Ø¯ÛŒØ¯ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª ØªÙ†Ø¸ÛŒÙ… Ø´Ø¯",sendMessage(a,t,r);break;case"changeName":if(r=[[{text:"ğŸ”™ Ø¨Ø§Ø²Ú¯Ø´Øª",callback_data:"profile"}]],"string"!=typeof i||i.length<3||i.length>32)return t="âŒ ÙˆØ±ÙˆØ¯ÛŒ Ø¨Ø§ÛŒØ¯ Ú©Ù„Ù…Ù‡ Ø§ÛŒ Ø¨Ù‡ Ø·ÙˆÙ„ 3 ØªØ§ 32 Ø­Ø±Ù Ø¨Ø§Ø´Ø¯",void sendMessage(a,t,r);if(!await db.updateUsersName(i,a))return t="âŒ Ù…Ø´Ú©Ù„ÛŒ Ù¾ÛŒØ´ Ø¢Ù…Ø¯. Ù„Ø·ÙØ§ Ø¯ÙˆØ¨Ø§Ø±Ù‡ ØªÙ„Ø§Ø´ Ú©Ù†ÛŒØ¯",void sendMessage(a,t,r);t="âœ… Ù†Ø§Ù… Ø¬Ø¯ÛŒØ¯ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª ØªÙ†Ø¸ÛŒÙ… Ø´Ø¯",sendMessage(a,t,r);break;case"watermark":try{const a=await e.telegram.getFileLink(e.message.document.file_id),r=await axios.get(a,{responseType:"arraybuffer"}),s=Buffer.from(r.data);if("image/png"===mime.lookup(e.message.document.file_name)){const e="./media/watermark.png",a=path.join(__dirname,e);await fs.promises.writeFile(a,s),logger.info(`new watermark PNG file saved: ${e}`),t="âœ… ÙˆØ§ØªØ±Ù…Ø§Ø±Ú© Ø¬Ø¯ÛŒØ¯ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª ØªÙ†Ø¸ÛŒÙ… Ø´Ø¯"}else t="â—ï¸ Ù…Ø´Ú©Ù„ÛŒ Ø¯Ø± ØªØ¬Ø²ÛŒÙ‡ ØªØµÙˆÛŒØ± Ù¾ÛŒØ´ Ø¢Ù…Ø¯. Ù„Ø·ÙØ§ Ù…Ø¬Ø¯Ø¯Ø§ Ø§Ù…ØªØ­Ø§Ù† Ú©Ù†ÛŒØ¯"}catch(e){logger.error("Error processing media: "+e),t="â—ï¸ Ù…Ø´Ú©Ù„ÛŒ Ø¯Ø± ØªØ¬Ø²ÛŒÙ‡ ØªØµÙˆÛŒØ± Ù¾ÛŒØ´ Ø¢Ù…Ø¯. Ù„Ø·ÙØ§ Ù…Ø¬Ø¯Ø¯Ø§ Ø§Ù…ØªØ­Ø§Ù† Ú©Ù†ÛŒØ¯"}finally{r=[[{text:" Ø¨Ø§Ø²Ú¯Ø´Øª",callback_data:"settings"}]],sendMessage(a,t,r)}break;case"newPost":const d=e.message;r=[[{text:"ğŸ”™ Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù…Ù†ÙˆÛŒ Ø§ØµÙ„ÛŒ",callback_data:"start"}]];try{const s=uuidv4();if(await db.createPost(a,s),t='ğŸŒ… Ù„Ø·ÙØ§ Ù…Ø­Ù„ Ù‚Ø±Ø§Ø±Ú¯ÛŒØ±ÛŒ ÙˆØ§ØªØ±Ù…Ø§Ø±Ú© Ø±Ø§ Ù…Ø´Ø®Øµ Ú©Ù†ÛŒØ¯:\nØ¬Ù‡Øª Ø±Ø¯ Ú©Ø±Ø¯Ù† Ø§ÛŒÙ† Ù‚Ø³Ù…Øª Ú¯Ø²ÛŒÙ†Ù‡ "â­•ï¸ ÙˆØ§ØªØ±Ù…Ø§Ø±Ú© Ù†Ø²Ù†" Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯',r=[[{text:"â†–ï¸",callback_data:"watermarkPosition/northwest_"+s},{text:"â¬†ï¸",callback_data:"watermarkPosition/north_"+s},{text:"â†—ï¸",callback_data:"watermarkPosition/northeast_"+s}],[{text:"â¬…ï¸",callback_data:"watermarkPosition/west_"+s},{text:"âºï¸",callback_data:"watermarkPosition/center_"+s},{text:"â¡ï¸",callback_data:"watermarkPosition/east_"+s}],[{text:"â†™ï¸",callback_data:"watermarkPosition/southwest_"+s},{text:"â¬‡ï¸",callback_data:"watermarkPosition/south_"+s},{text:"â†˜ï¸",callback_data:"watermarkPosition/southeast_"+s}],[{text:"â­•ï¸ ÙˆØ§ØªØ±Ù…Ø§Ø±Ú© Ù†Ø²Ù†",callback_data:"watermarkPosition/none_"+s}],[{text:"ğŸ”™ Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù…Ù†ÙˆÛŒ Ø§ØµÙ„ÛŒ",callback_data:"start"}]],d.video){const i=d.video.file_id,o=await e.telegram.getFileLink(i),n=await axios.get(o,{responseType:"arraybuffer"}),l=Buffer.from(n.data),c=`./media/${s}.mp4`,g=path.join(__dirname,c);await fs.promises.writeFile(g,l);let m={caption:"",media:s,filetype:"mp4",created:Date.now(),output:s};setTimer(g);let p=await signMessages(d.caption,a);if(!p.ok)break;m.caption=p.data;const f=path.join(__dirname,`./media/${s}.json`),w=JSON.stringify(m);await fs.promises.writeFile(f,w),setTimer(f);const b=await db.getConfig("isWatermark");if(!b.ok)break;if(!(1===b.data.value||"1"===b.data.value)){let t=await pq.process_queries(a,"watermarkPosition/none_"+s,e,m);sendMessage(a,t.messageText,t.inlineKeyboard,void 0,!1,!0,t.media);break}sendMessage(a,t,r,m)}else if(d.photo){const i=d.photo,o=i[i.length-1].file_id,n=await e.telegram.getFileLink(o),l=await axios.get(n,{responseType:"arraybuffer"}),c=Buffer.from(l.data),g=`./media/${s}.jpg`,m=path.join(__dirname,g);await fs.promises.writeFile(m,c);let p={caption:"",media:s,filetype:"jpg",created:Date.now(),output:s};setTimer(m);let f=await signMessages(d.caption,a);if(!f.ok)break;p.caption=f.data;const w=path.join(__dirname,`./media/${s}.json`),b=JSON.stringify(p);await fs.promises.writeFile(w,b),setTimer(w);const u=await db.getConfig("isWatermark");if(!u.ok)break;if(!(1===u.data.value||"1"===u.data.value)){let t=await pq.process_queries(a,"watermarkPosition/none",e,p);sendMessage(a,t.messageText,t.inlineKeyboard,void 0,!1,!0,t.media);break}sendMessage(a,t,r)}else if(d.text){let s=await signMessages(i,a);if(!s.ok)break;t=s.data,e.reply("â‰ï¸Ø¢ÛŒØ§ Ø§Ø² Ø§Ø±Ø³Ø§Ù„ Ù¾ÛŒØ§Ù… Ø²ÛŒØ± Ø¯Ø± Ú©Ø§Ù†Ø§Ù„ Ù…Ø·Ù…Ø¦Ù† Ù‡Ø³ØªÛŒØ¯ØŸ"),r=[[{text:"âœ… ØªØ§ÛŒÛŒØ¯ Ùˆ Ø§Ø±Ø³Ø§Ù„",callback_data:"confirmPost/text"}],[{text:"ğŸ”™ Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù…Ù†ÙˆÛŒ Ø§ØµÙ„ÛŒ",callback_data:"start_again"}]],sendMessage(a,t,r)}}catch(e){r=[[{text:"ğŸ”™ Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù…Ù†ÙˆÛŒ Ø§ØµÙ„ÛŒ",callback_data:"start"}]],logger.error("Error in handling new posts data: "+e),t="â—ï¸ Ù…Ø´Ú©Ù„ÛŒ Ù¾ÛŒØ´ Ø¢Ù…Ø¯. Ù„Ø·ÙØ§ Ù…Ø¬Ø¯Ø¯Ø§ Ø§Ù…ØªØ­Ø§Ù† Ú©Ù†ÛŒØ¯",sendMessage(a,t,r)}}}catch(e){logger.error("Error in reading user input:"+e)}s&&(localVariable[a].receiver="")})),bot.launch().then(logger.info("Bot started successfully!")).catch((e=>{logger.error("Error starting the bot: "+e)}));